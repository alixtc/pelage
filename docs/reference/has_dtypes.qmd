# has_dtypes { #pelage.has_dtypes }

```python
has_dtypes(data, items)
```

Check that the columns have the expected types

## Parameters {.doc-section .doc-section-parameters}

<code><span class="parameter-name">data</span><span class="parameter-annotation-sep">:</span> <span class="parameter-annotation">[PolarsLazyOrDataFrame](`pelage.types.PolarsLazyOrDataFrame`)</span></code>

:   Polars DataFrame or LazyFrame containing data to check.

<code><span class="parameter-name">items</span><span class="parameter-annotation-sep">:</span> <span class="parameter-annotation">[Dict](`typing.Dict`)\[[str](`str`), [PolarsDataType](`pelage.types.PolarsDataType`)\]</span></code>

:   A dictionnary of column name with their expected polars data type:
    ```
    {
        "col_a": pl.String,
        "col_b": pl.Int64,
        "col_c": pl.Float64,
        ...
    }
    ```

## Returns {.doc-section .doc-section-returns}

| Name   | Type                                                          | Description                                                      |
|--------|---------------------------------------------------------------|------------------------------------------------------------------|
|        | [PolarsLazyOrDataFrame](`pelage.types.PolarsLazyOrDataFrame`) | The original polars DataFrame or LazyFrame when the check passes |

## Examples {.doc-section .doc-section-examples}

```python
>>> import polars as pl
>>> import pelage as plg
>>> df = pl.DataFrame({
...     "name": ["Alice", "Bob", "Charlie"],
...     "age": [20, 30, 40],
...     "city": ["New York", "London", "Paris"],
... })
>>> df.pipe(plg.has_dtypes, {
...     "name": pl.String,
...     "age": pl.Int64,
...     "city": pl.String,
... })
shape: (3, 3)
┌─────────┬─────┬──────────┐
│ name    ┆ age ┆ city     │
│ ---     ┆ --- ┆ ---      │
│ str     ┆ i64 ┆ str      │
╞═════════╪═════╪══════════╡
│ Alice   ┆ 20  ┆ New York │
│ Bob     ┆ 30  ┆ London   │
│ Charlie ┆ 40  ┆ Paris    │
└─────────┴─────┴──────────┘
```

```python
>>> df.pipe(plg.has_dtypes, {
...     "age": pl.String,
...     "city": pl.Int64,
... })
Traceback (most recent call last):
    ...
pelage.types.PolarsAssertError: Details
Error with the DataFrame passed to the check function:
--> Some columns don't have the expected type:
column='age', expected_type=String, real_dtype=Int64
column='city', expected_type=Int64, real_dtype=String
```
